<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Constrained accessibility — constrained_accessibility • accessibility</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Constrained accessibility — constrained_accessibility"><meta name="description" content="Calculates accessibility using constraints, as proposed in
Soukhov et al. (2025)
. Accessibility is
conceptualised as potential' spatial interaction. The results are in units of
opportunities in the region (i.e., active accessibility active = TRUE) or
in units of population in the region (if active = FALSE reflecting passive
accessibility). Results are presented as a sum of a zone or presented as an
origin-destination flow (if detailed_results = TRUE). Please see Details
section for more information.
This function is generic over any kind of numeric travel cost,
such as distance, time and money."><meta property="og:description" content="Calculates accessibility using constraints, as proposed in
Soukhov et al. (2025)
. Accessibility is
conceptualised as potential' spatial interaction. The results are in units of
opportunities in the region (i.e., active accessibility active = TRUE) or
in units of population in the region (if active = FALSE reflecting passive
accessibility). Results are presented as a sum of a zone or presented as an
origin-destination flow (if detailed_results = TRUE). Please see Details
section for more information.
This function is generic over any kind of numeric travel cost,
such as distance, time and money."><meta property="og:image" content="https://ipeagit.github.io/accessibility/logo.png"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">accessibility</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/accessibility.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/decay_functions.html">Decay functions</a></li>
    <li><a class="dropdown-item" href="../articles/inequality_and_poverty.html">Calculating accessibility inequality and poverty</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ipeaGIT/accessibility/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Constrained accessibility</h1>
      <small class="dont-index">Source: <a href="https://github.com/ipeaGIT/accessibility/blob/main/R/constrained_accessibility.R" class="external-link"><code>R/constrained_accessibility.R</code></a></small>
      <div class="d-none name"><code>constrained_accessibility.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates accessibility using constraints, as proposed in
Soukhov et al. (2025)
. Accessibility is
conceptualised as potential' spatial interaction. The results are in units of
opportunities in the region (i.e., active accessibility <code>active = TRUE</code>) or
in units of population in the region (if <code>active = FALSE</code> reflecting passive
accessibility). Results are presented as a sum of a zone or presented as an
origin-destination flow (if <code>detailed_results = TRUE</code>). Please see Details
section for more information.</p>
<p>This function is generic over any kind of numeric travel cost,
such as distance, time and money.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">constrained_accessibility</span><span class="op">(</span></span>
<span>  <span class="va">constraint</span>,</span>
<span>  <span class="va">travel_matrix</span>,</span>
<span>  <span class="va">land_use_data</span>,</span>
<span>  <span class="va">travel_cost</span>,</span>
<span>  <span class="va">decay_function</span>,</span>
<span>  demand <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  supply <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  active <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  error_threshold <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  improvement_threshold <span class="op">=</span> <span class="fl">1e-06</span>,</span>
<span>  max_iterations <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  group_by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  fill_missing_ids <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  detailed_results <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-constraint">constraint<a class="anchor" aria-label="anchor" href="#arg-constraint"></a></dt>
<dd><p>A string. One of <code>"total"</code>, <code>"singly"</code>, or <code>"doubly"</code>. See
Details section for more information.</p></dd>


<dt id="arg-travel-matrix">travel_matrix<a class="anchor" aria-label="anchor" href="#arg-travel-matrix"></a></dt>
<dd><p>A data frame. The travel matrix describing the costs
(i.e. travel time, distance, monetary cost, etc.) between the origins and
destinations in the study area. Must contain the columns <code>from_id</code>, <code>to_id</code>
and any others specified in <code>travel_cost</code>.</p></dd>


<dt id="arg-land-use-data">land_use_data<a class="anchor" aria-label="anchor" href="#arg-land-use-data"></a></dt>
<dd><p>A data frame. The distribution of opportunities within
the study area cells. Must contain the columns <code>id</code> and any others
specified in <code>opportunity</code>.</p></dd>


<dt id="arg-travel-cost">travel_cost<a class="anchor" aria-label="anchor" href="#arg-travel-cost"></a></dt>
<dd><p>A string. The name of the column in <code>travel_matrix</code>
with the travel cost between origins and destinations.</p></dd>


<dt id="arg-decay-function">decay_function<a class="anchor" aria-label="anchor" href="#arg-decay-function"></a></dt>
<dd><p>A <code>fuction</code> that converts travel cost into an
impedance factor used to weight opportunities. This function should take a
<code>numeric</code> vector and also return a <code>numeric</code> vector as output, with the
same length as the input. For convenience, the package currently includes
the following functions: <code><a href="decay_binary.html">decay_binary()</a></code>, <code><a href="decay_exponential.html">decay_exponential()</a></code>,
<code><a href="decay_power.html">decay_power()</a></code> and <code><a href="decay_stepped.html">decay_stepped()</a></code>. See the documentation of each decay
function for more details.</p></dd>


<dt id="arg-demand">demand<a class="anchor" aria-label="anchor" href="#arg-demand"></a></dt>
<dd><p>A string. The name of the column in <code>land_use_data</code> with the
number of opportunity-demanders at each origin (e.g., people) that will be
considered.</p></dd>


<dt id="arg-supply">supply<a class="anchor" aria-label="anchor" href="#arg-supply"></a></dt>
<dd><p>A string. The name of the column in <code>land_use_data</code> with the
number of opportunity supply at each destination (e.g., jobs, school-seats)
that will be considered.</p></dd>


<dt id="arg-active">active<a class="anchor" aria-label="anchor" href="#arg-active"></a></dt>
<dd><p>A logical. When <code>TRUE</code>, the function calculates active
accessibility (the quantity of opportunities that can be reached from
a given origin). When <code>FALSE</code>, it calculates passive accessibility (by
how many people each destination can be reached), which is equivalent
to the notion of market potential. This parameter only works for
<code>constraint</code> types <code>"total"</code> and <code>"singly"</code>. Ignored for
<code>constraint = "doubly"</code>.</p></dd>


<dt id="arg-error-threshold">error_threshold<a class="anchor" aria-label="anchor" href="#arg-error-threshold"></a></dt>
<dd><p>Numeric. Convergence criterion used only for
calibration in the doubly-constrained case (<code>constraint = "doubly"</code>).</p></dd>


<dt id="arg-improvement-threshold">improvement_threshold<a class="anchor" aria-label="anchor" href="#arg-improvement-threshold"></a></dt>
<dd><p>Numeric. Convergence criterion for improvement
used only for calibration in the doubly-constrained case
(<code>constraint = "doubly"</code>).</p></dd>


<dt id="arg-max-iterations">max_iterations<a class="anchor" aria-label="anchor" href="#arg-max-iterations"></a></dt>
<dd><p>Integer. Maximum iterations used only for calibration
in the doubly-constrained case (<code>constraint = "doubly"</code>).</p></dd>


<dt id="arg-group-by">group_by<a class="anchor" aria-label="anchor" href="#arg-group-by"></a></dt>
<dd><p>A <code>character</code> vector. When not <code>character(0)</code> (the default),
indicates the <code>travel_matrix</code> columns that should be used to group the
accessibility estimates by. For example, if <code>travel_matrix</code> includes a
departure time column, that specifies the departure time of each entry in
the data frame, passing <code>"departure_time"</code> to this parameter results in
accessibility estimates grouped by origin and by departure time.</p></dd>


<dt id="arg-fill-missing-ids">fill_missing_ids<a class="anchor" aria-label="anchor" href="#arg-fill-missing-ids"></a></dt>
<dd><p>A <code>logical</code>. When calculating grouped accessibility
estimates (i.e. when <code>by_col</code> is not <code>NULL</code>), some combinations of groups
and origins may be missing. For example, if a single trip can depart from
origin <code>A</code> at 7:15am and reach destination <code>B</code> within 55 minutes, but no
trips departing from <code>A</code> at 7:30am can be completed at all, this second
combination will not be included in the output. When <code>TRUE</code> (the default),
the function identifies which combinations would be left out and fills
their respective accessibility values with 0, which incurs in a
performance penalty.</p></dd>


<dt id="arg-detailed-results">detailed_results<a class="anchor" aria-label="anchor" href="#arg-detailed-results"></a></dt>
<dd><p>Logical. Whether to return detailed OD-level results.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The following three constraint cases (along with their <code>active</code> and passive
variants) are included:</p><ul><li><p><code>"total"</code>: Allocates the system-wide total proportionally based on travel
impedance.</p></li>
<li><p>If <code>active = TRUE</code>, results are in units of  <strong>opportunities</strong> (supply)
accessible by the origin. Only <code>supply</code> can be passed, <code>demand</code> must be NULL.</p></li>
<li><p>If <code>active = FALSE</code>, results are in units of  <strong>population</strong> (demand)
accessible by the destination. Only <code>demand</code> can be passed, <code>supply</code> must
be NULL.</p></li>
<li><p>If <code>detailed_results = TRUE</code>, accessibility (in units corresponding to the
logical for <code>active</code>) is presented as a flow along with intermediates.</p></li>
<li><p><code>"singly"</code>: Applies a single constraint, allocating one side of the marginal
proportionally based on the other marginal and travel impedance:</p></li>
<li><p>If <code>active = TRUE</code>, returns origin-side results (how much supply is
accessible from each origin). Outputs are units of supply. <code>demand</code> and
<code>supply</code> must be passed.</p></li>
<li><p>If <code>active = FALSE</code>, returns destination-side results (how much demand is
accessible from each destination). Outputs are units of demand. <code>demand</code> and
<code>supply</code> must be passed.</p></li>
<li><p>If <code>detailed_results = TRUE</code>, accessibility (in units corresponding to the
logical for <code>active</code>) is presented as a flow along with intermediates.</p></li>
<li><p><code>"doubly"</code>: Allocates flows so supply at each destination matches demand at
each origin.</p></li>
<li><p>OD flows are calibrated to both marginals. OD flows are calibrated to both
marginals using iterative proportional fitting. The sum of <code>demand</code> and
<code>supply</code> must match; otherwise, the function will not converge.</p></li>
<li><p><code>active</code> and <code>detailed_results</code> must be NULL. Since supply must match
demand, their units are the same and there is no distinction between 'active'
and 'passive' notions.</p></li>
</ul><p>Please see the Details section for more information.</p>
    </div>
    <div class="section level2">
    <h2 id="details-1">Details<a class="anchor" aria-label="anchor" href="#details-1"></a></h2>


<p>This function covers the family of constrained accessibility measures
proposed in Soukhov et al. (2025)
.</p><div class="section">
<h3 id="total-constrained-accessibility">Total Constrained Accessibility<a class="anchor" aria-label="anchor" href="#total-constrained-accessibility"></a></h3>


<p>Allocates the total system-wide quantity proportionally based on travel
impedance between origins and destinations. This measure uses the logic of a
total ~(or 'unconstrained' by Wilson's terms)~ constraint.</p>
<p>Use this measure when the total quantity of <strong>supply</strong> OR <strong>demand</strong> in the
system is known and representing accessibility as a proportion of this total
is meaningful.</p>
<p><strong>Requirements</strong>:</p><ul><li><p>Either <code>demand</code> or <code>supply</code> must be provided (cannot provide both).</p></li>
</ul><p><strong>Interpretation</strong>:</p><ul><li><p><code>active = TRUE</code> (<em>active accessibility</em>): Results represent the total
number of  <strong>opportunities</strong> (supply) accessible from each origin based on
region-relative travel impedance. The units are in 'supply' (e.g., jobs,
school seats).</p><ul><li><p>If <code>detailed_results = FALSE</code>, outputs are aggregated and returned by
origin.</p></li>
<li><p>If <code>detailed_results = TRUE</code>, OD-level flows are returned. Summing flows
by origin equals the aggregated result.</p></li>
</ul></li>
<li><p><code>active = FALSE</code> (<em>passive accessibility</em>, the notion of market potential):
Results represent the total number of <strong>population</strong> (demand) that can reach
each destination based on region-relative travel impedance. The units are in
'demand' (e.g., population).</p><ul><li><p>If <code>detailed_results = FALSE</code>, outputs are aggregated by destination.</p></li>
<li><p>If <code>detailed_results = TRUE</code>, OD-level flows are returned. Summing flows
by destination equals the aggregated result.</p></li>
</ul></li>
</ul><p><strong>Use cases</strong>:</p><ul><li><p>Active accessibility (aggregated):
"How many jobs can be reached from origin zone A given its region-relative
travel impedance?"</p></li>
<li><p>Active accessibility (flow-level):
"How many jobs can be reached by flow A-&gt;1 given A-&gt;1's region-relative
travel impedance?"</p></li>
<li><p>Passive accessibility (aggregated):
"How many people can reach destination zone 1 given its region-relative
travel impedance?"</p></li>
<li><p>Passive accessibility (flow-level):
"How many people are reached by flow 1-&gt;A given 1-&gt;A's region-relative
travel impedance?"</p></li>
</ul></div>

<div class="section">
<h3 id="singly-constrained-accessibility">Singly Constrained Accessibility<a class="anchor" aria-label="anchor" href="#singly-constrained-accessibility"></a></h3>


<p>Allocates opportunities at each destination (or population at each origin)
proportionally based on travel impedance and the opposite marginal. This
measure uses the logic of single constraint from
Wilson (1971)
.</p>
<p>Use this measure when modeling <strong>competition</strong>, where both demand and supply
are conceptualised to influence accessibility but only one side is fixed.
The measure distributes flows so that totals match the constrained side
while weighting by travel impedance and the unconstrained side.</p>
<p><strong>Requirements</strong>:</p><ul><li><p>Both <code>demand</code> and <code>supply</code> must be provided (the logical for <code>active</code>
determines if either demand or supply is constrained).</p></li>
</ul><p><strong>Interpretation</strong>:</p><ul><li><p><code>active = TRUE</code> (<em>active accessibility</em>): constrains supply. Results
represent the total number of <strong>opportunities</strong> (supply) accessible from each
origin based on region-relative travel impedance and population at the origin.
The units are in 'supply' (e.g., jobs, school seats).</p><ul><li><p>If <code>detailed_results = FALSE</code>, outputs are aggregated and returned by origin.</p></li>
<li><p>If <code>detailed_results = TRUE</code>, OD-level flows are returned. Summing flows
by origin equals the aggregated result.</p></li>
</ul></li>
<li><p><code>active = FALSE</code> (<em>passive accessibility</em>, the notion of market potential):
constrains demand. Results represent the total number of
<strong>population</strong> (demand) that can reach each destination based on
region-relative travel impedance and opportunities at the destination. The
units are in 'demand' (e.g., population).</p><ul><li><p>If <code>detailed_results = FALSE</code>, outputs are aggregated by destination.</p></li>
<li><p>If <code>detailed_results = TRUE</code>, OD-level flows are returned. Summing flows
by destination equals the aggregated result.</p></li>
</ul></li>
</ul><p><strong>Use cases</strong>:</p><ul><li><p>Active accessibility (aggregated):
"How many jobs can be reached from origin zone A given its region-relative
travel impedance and demand?"</p></li>
<li><p>Active accessibility (flow-level):
"How many jobs can be reached by flow A-&gt;1 given A-&gt;1's region-relative
travel impedance and demand?"</p></li>
<li><p>Passive accessibility (aggregated):
"How many people can reach destination zone 1 given its region-relative
travel impedance and supply?"</p></li>
<li><p>Passive accessibility (flow-level):
"How many people are reached by flow 1-&gt;A given 1-&gt;A's region-relative
travel impedance and supply?"</p></li>
</ul><p><strong>NOTE:</strong> the active form of this measure yields equivalent results to the
<code><a href="spatial_availability.html">spatial_availability()</a></code> function, through different logic.</p>
</div>

<div class="section">
<h3 id="doubly-constrained-accessibility">Doubly Constrained Accessibility<a class="anchor" aria-label="anchor" href="#doubly-constrained-accessibility"></a></h3>


<p>Allocates flows between origins and destinations using Wilson's <em>doubly-constrained</em>
gravity model Wilson (1971)
.</p>
<p>The model uses iterative proportional fitting to update balancing factors
(<code>A_i</code> for origins and <code>B_j</code> for destinations) until convergence. This guarantees
that flows satisfy both marginals while being weighted by travel impedance.</p>
<p><strong>Requirements</strong>:</p><ul><li><p>Both <code>demand</code> and <code>supply</code> must be provided.</p></li>
<li><p>Unlike <code>total</code> and <code>singly</code>, <code>doubly</code> requires the sum of demand and supply
to match; otherwise, the model will not converge.</p></li>
</ul><p><strong>Interpretation</strong>:</p><ul><li><p>When <code>detailed_results = TRUE</code>, results include OD-level flows (<code>flow</code>)
along with balancing factors (<code>A_i</code>, <code>B_j</code>) and travel impedance weights.
The resulting flows represent the distribution of demand and supply across
all origin-destination pairs. NOTE: OD flows are in flow units (jointly
determined by demand and supply).</p></li>
<li><p>When <code>detailed_results = FALSE</code>, results are not returned. As the
aggregated outputs simply return the supply at destinations or demand at
origin that was fed into <code>demand</code> and <code>supply</code> parameters.
<code>detailed_results = TRUE</code> should only be used.</p></li>
</ul><p><strong>Use cases</strong>:</p><ul><li><p>flow-level:
"What is the count of A-&gt;1 flows given A-&gt;1's region-relative travel impedance,
demand and supply?"</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Soukhov A, Pereira RH, Higgins CD, Páez A (2025).
“A family of accessibility measures derived from spatial interaction principles.”
<em>PLoS One</em>, <b>20</b>(11), e0335951.<br><br> Wilson AG (1971).
“A family of spatial interaction models, and associated developments.”
<em>Environment and Planning A</em>, <b>3</b>(1), 1–32.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Constrained accessibility:
<code><a href="spatial_availability.html">spatial_availability()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load demo data shipped with the package</span></span></span>
<span class="r-in"><span><span class="va">data_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"accessibility"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">travel_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"travel_matrix.rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">land_use_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">data_dir</span>, <span class="st">"land_use_data.rds"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Total-constrained (active accessibility, aggregated): returns units of</span></span></span>
<span class="r-in"><span><span class="co"># accessible supply by origin (requires supply)</span></span></span>
<span class="r-in"><span><span class="fu">constrained_accessibility</span><span class="op">(</span></span></span>
<span class="r-in"><span>  constraint <span class="op">=</span>   <span class="st">"total"</span>,</span></span>
<span class="r-in"><span>  travel_matrix <span class="op">=</span> <span class="va">travel_matrix</span>,</span></span>
<span class="r-in"><span>  land_use_data <span class="op">=</span> <span class="va">land_use_data</span>,</span></span>
<span class="r-in"><span>  travel_cost     <span class="op">=</span> <span class="st">"travel_time"</span>,</span></span>
<span class="r-in"><span>  decay_function  <span class="op">=</span> <span class="fu"><a href="decay_exponential.html">decay_exponential</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  demand          <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  supply          <span class="op">=</span> <span class="st">"jobs"</span>,</span></span>
<span class="r-in"><span>  active <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  detailed_results <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              from_id   supply</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               &lt;char&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 89a88cdb57bffff 263.8175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 89a88cdb597ffff 264.7306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 89a88cdb5b3ffff 319.5332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 89a88cdb5cfffff 428.2523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 89a88cd909bffff 291.7166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 894: 89a881acda3ffff 280.1091</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 895: 89a88cdb543ffff 697.2299</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 896: 89a88cda667ffff 346.8143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 897: 89a88cd900fffff 113.1569</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 898: 89a881aebafffff   0.0000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Total-constrained (passive accessibility, aggregated): returns units of</span></span></span>
<span class="r-in"><span><span class="co"># accessible demand by destination  (requires demand)</span></span></span>
<span class="r-in"><span><span class="fu">constrained_accessibility</span><span class="op">(</span></span></span>
<span class="r-in"><span>  constraint <span class="op">=</span>   <span class="st">"total"</span>,</span></span>
<span class="r-in"><span>  travel_matrix <span class="op">=</span> <span class="va">travel_matrix</span>,</span></span>
<span class="r-in"><span>  land_use_data <span class="op">=</span> <span class="va">land_use_data</span>,</span></span>
<span class="r-in"><span>  travel_cost     <span class="op">=</span> <span class="st">"travel_time"</span>,</span></span>
<span class="r-in"><span>  decay_function  <span class="op">=</span> <span class="fu"><a href="decay_exponential.html">decay_exponential</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  demand          <span class="op">=</span> <span class="st">"population"</span>,</span></span>
<span class="r-in"><span>  supply          <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>  active <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  detailed_results <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                to_id       demand</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               &lt;char&gt;        &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 89a88cdb57bffff  720.1584302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 89a88cdb597ffff  958.7228358</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 89a88cdb5b3ffff 1074.8576863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 89a88cdb5cfffff  632.9250575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 89a88cd909bffff  882.5883640</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 894: 89a881ae92fffff   13.4118931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 895: 89a881ae923ffff    0.2403741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 896: 89a881ae9afffff    3.6023628</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 897: 89a88cd8407ffff   27.6942661</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 898: 89a881aebafffff    0.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Singly-constrained (active accessibility, aggregated): returns units of</span></span></span>
<span class="r-in"><span><span class="co"># accessible supply by origin (requires supply and demand)</span></span></span>
<span class="r-in"><span><span class="fu">constrained_accessibility</span><span class="op">(</span></span></span>
<span class="r-in"><span>  constraint <span class="op">=</span>   <span class="st">"singly"</span>,</span></span>
<span class="r-in"><span>  travel_matrix <span class="op">=</span> <span class="va">travel_matrix</span>,</span></span>
<span class="r-in"><span>  land_use_data <span class="op">=</span> <span class="va">land_use_data</span>,</span></span>
<span class="r-in"><span>  travel_cost     <span class="op">=</span> <span class="st">"travel_time"</span>,</span></span>
<span class="r-in"><span>  decay_function  <span class="op">=</span> <span class="fu"><a href="decay_exponential.html">decay_exponential</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  demand          <span class="op">=</span> <span class="st">"population"</span>,</span></span>
<span class="r-in"><span>  supply          <span class="op">=</span> <span class="st">"jobs"</span>,</span></span>
<span class="r-in"><span>  active <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  detailed_results <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              from_id    supply</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               &lt;char&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1: 89a88cdb57bffff  186.0876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2: 89a88cdb597ffff  140.0738</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3: 89a88cdb5b3ffff  736.5830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4: 89a88cdb5cfffff  900.9284</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5: 89a88cd909bffff    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  ---                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 894: 89a881acda3ffff  453.8818</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 895: 89a88cdb543ffff 1184.0239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 896: 89a88cda667ffff  276.2530</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 897: 89a88cd900fffff  103.5370</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 898: 89a881aebafffff    0.0000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Doubly-constrained: returns units of flow (requires both demand and supply</span></span></span>
<span class="r-in"><span><span class="co"># (totals that match) and `detailed_results = TRUE`)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using a small toy dataset with matching totals.</span></span></span>
<span class="r-in"><span><span class="va">tm_small</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>from_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span><span class="op">)</span>, to_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tm_small</span><span class="op">[</span>, <span class="va">travel_time</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">15</span>, <span class="fl">30</span>, <span class="fl">10</span>, <span class="fl">25</span>, <span class="fl">15</span>, <span class="fl">25</span>, <span class="fl">10</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from_id  to_id travel_time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;fctr&gt; &lt;fctr&gt;       &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:       1      1          10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:       2      1          30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:       3      1          15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:       1      2          30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:       2      2          10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:       3      2          25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:       1      3          15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:       2      3          25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9:       3      3          10</span>
<span class="r-in"><span><span class="va">lu_small</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  id         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  population <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">10</span>, <span class="fl">6</span><span class="op">)</span>,   <span class="co"># sum = 20</span></span></span>
<span class="r-in"><span>  jobs       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,  <span class="fl">5</span>,  <span class="fl">8</span><span class="op">)</span>   <span class="co"># sum = 20</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">constrained_accessibility</span><span class="op">(</span></span></span>
<span class="r-in"><span>  constraint <span class="op">=</span> <span class="st">"doubly"</span>,</span></span>
<span class="r-in"><span>  travel_matrix <span class="op">=</span> <span class="va">tm_small</span>,</span></span>
<span class="r-in"><span>  land_use_data <span class="op">=</span> <span class="va">lu_small</span>,</span></span>
<span class="r-in"><span>  travel_cost     <span class="op">=</span> <span class="st">"travel_time"</span>,</span></span>
<span class="r-in"><span>  decay_function  <span class="op">=</span> <span class="fu"><a href="decay_exponential.html">decay_exponential</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  demand          <span class="op">=</span> <span class="st">"population"</span>,</span></span>
<span class="r-in"><span>  supply          <span class="op">=</span> <span class="st">"jobs"</span>,</span></span>
<span class="r-in"><span>  detailed_results <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    from_id  to_id       flow       A_i      B_j kappa_doubly        error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;fctr&gt; &lt;fctr&gt;      &lt;num&gt;     &lt;num&gt;    &lt;num&gt;        &lt;num&gt;        &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:       1      1 2.52693730 0.1721781 1.424797   0.36099104 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:       1      2 0.09995405 0.1721781 0.583010   0.01999081 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:       1      3 1.37651660 0.1721781 1.119684   0.17206457 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:       2      1 2.15341665 0.4336710 1.424797   0.30763095 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:       2      2 4.65063122 0.4336710 0.583010   0.93012624 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:       2      3 3.18866969 0.4336710 1.119684   0.39858371 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:       3      1 2.31964604 0.1737245 1.424797   0.33137801 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:       3      2 0.24941474 0.1737245 0.583010   0.04988295 0.0007282441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9:       3      3 3.43481370 0.1737245 1.119684   0.42935171 0.0007282441</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rafael H. M. Pereira, Daniel Herszenhut, Ipea - Institute for Applied Economic Research.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

